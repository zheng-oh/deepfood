"use strict";const t=require("../common/vendor.js"),I=t.defineStore("img",{state:()=>{const o=t.ref({width:0,height:0,url:"",data:[],ratio:1,is_kuan:!1,re_plot:!1}),r=t.ref({tagwidth:750,tagheight:900,width:0,height:0}),s=t.ref({x:0,y:0,x_ratio:1,y_ratio:1}),e=t.ref({x:100,y:100,radius:60,lineWidth:20,color:"red",cover:!0}),h=t.ref({red:0,green:0,blue:0,rgb:"RGB(0, 0, 0)  Hex(#000000)",hexColor:""}),i=t.ref([]),n=t.index.getSystemInfoSync().pixelRatio,c=t.ref(null),u=t.ref(null),f=t.index.getSystemInfoSync().screenHeight;return{drp:n,canvasInfo:r,imgInfo:o,touchInfo:s,cursorInfo:e,ctxImg:c,ctxCursor:u,pickerColor:h,dbColors:i,screenHeight:f}},getters:{},actions:{deleteImage(){this.imgInfo.url=""},handleTouchStart(o){this.pickerColor.hexColor="";const r=o.touches[0];this.touchInfo.x=r.x,this.touchInfo.y=r.y,this.cursorInfo.x=this.touchInfo.x*this.touchInfo.x_ratio,this.cursorInfo.y=this.touchInfo.y*this.touchInfo.y_ratio,this.getImageRGB()},handleTouchMove(o){const r=o.touches[0];this.touchInfo.x=r.x,this.touchInfo.y=r.y,this.cursorInfo.x=this.touchInfo.x*this.touchInfo.x_ratio,this.cursorInfo.y=this.touchInfo.y*this.touchInfo.y_ratio,this.cursorInfo.x<0?this.cursorInfo.x=0:this.cursorInfo.x>this.imgInfo.data.width&&(this.cursorInfo.x=this.imgInfo.data.width-1),this.cursorInfo.y<0?this.cursorInfo.y=0:this.cursorInfo.y>this.imgInfo.data.height&&(this.cursorInfo.y=this.imgInfo.data.height-1),this.getImageRGB()},handleTouchEnd(o){this.imgInfo.re_plot=!this.imgInfo.re_plot,this.drawCursor()},drawCursor(){this.ctxCursor.beginPath(),this.ctxCursor.lineWidth=this.cursorInfo.lineWidth,this.ctxCursor.moveTo(this.cursorInfo.x,this.cursorInfo.y-this.cursorInfo.radius),this.ctxCursor.lineTo(this.cursorInfo.x,this.cursorInfo.y+this.cursorInfo.radius),this.ctxCursor.moveTo(this.cursorInfo.x-this.cursorInfo.radius,this.cursorInfo.y),this.ctxCursor.lineTo(this.cursorInfo.x+this.cursorInfo.radius,this.cursorInfo.y),this.ctxCursor.strokeStyle=this.cursorInfo.color,this.ctxCursor.stroke()},getImageRGB(){const o=Math.round(this.cursorInfo.x),s=(Math.round(this.cursorInfo.y)*this.imgInfo.data.width+o)*4;this.pickerColor.red=this.imgInfo.data.data[s],this.pickerColor.green=this.imgInfo.data.data[s+1],this.pickerColor.blue=this.imgInfo.data.data[s+2],this.pickerColor.hexColor=this.rgbToHex(),this.pickerColor.rgb=`RGB(${this.pickerColor.red}, ${this.pickerColor.green}, ${this.pickerColor.blue})  Hex(${this.pickerColor.hexColor})`},rgbToHex(){const o=h=>{const i=h.toString(16);return i.length===1?"0"+i:i},r=o(this.pickerColor.red),s=o(this.pickerColor.green),e=o(this.pickerColor.blue);return`#${r}${s}${e}`}}});exports.useImgStore=I;
